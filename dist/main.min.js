(()=>{var S=class{constructor(){this._events={}}on(t,n,s={}){this._events[t]=this._events[t]||[],this._events[t].push({fn:n,options:s})}off(t,n){let s=this._events[t]||[];this._events[t]=s.filter(o=>o.fn!==n)}find(t){return this._events[t]}run(t,...n){let s=this._events[t]||[];return console.assert(s&&s.length>0,"No subscriber for event: "+t),this._events[t]=s.filter(o=>!o.options.once),s.forEach(o=>{let{fn:i,options:c}=o;return c.delay?this.delay(t,i,n,c):i.apply(this,n),!o.options.once}),s.length}once(t,n,s={}){this.on(t,n,Object.assign(Object.assign({},s),{once:!0}))}delay(t,n,s,o){o._t&&clearTimeout(o._t),o._t=setTimeout(()=>{clearTimeout(o._t),n.apply(this,s)},o.delay)}},A,w=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global;w.app&&w._AppRunVersions?A=w.app:(A=new S,w.app=A,w._AppRunVersions="AppRun-2");var a=A;function K(e,...t){return V(t)}function V(e){let t=[],n=s=>{s!=null&&s!==""&&s!==!1&&t.push(typeof s=="function"||typeof s=="object"?s:""+s)};return e&&e.forEach(s=>{Array.isArray(s)?s.forEach(o=>n(o)):n(s)}),t}var P=new WeakMap,I=function(e,t,n={}){if(t==null||t===!1)return;t=E(t,n);let s=(e==null?void 0:e.nodeName)==="SVG";!e||(Array.isArray(t)?j(e,t,s):j(e,[t],s))};function N(e,t,n){t._op!==3&&(n=n||t.tag==="svg",function(s,o){let i=s.nodeName,c=""+(o.tag||"");return i.toUpperCase()===c.toUpperCase()}(e,t)?(!(2&t._op)&&j(e,t.children,n),!(1&t._op)&&M(e,t.props,n)):e.parentNode.replaceChild(k(t,n),e))}function j(e,t,n){var s;let o=((s=e.childNodes)===null||s===void 0?void 0:s.length)||0,i=(t==null?void 0:t.length)||0,c=Math.min(o,i);for(let u=0;u<c;u++){let r=t[u];if(r._op===3)continue;let m=e.childNodes[u];if(typeof r=="string")m.textContent!==r&&(m.nodeType===3?m.nodeValue=r:e.replaceChild(T(r),m));else if(r instanceof HTMLElement||r instanceof SVGElement)e.insertBefore(r,m);else{let p=r.props&&r.props.key;if(p)if(m.key===p)N(e.childNodes[u],r,n);else{let g=P[p];if(g){let d=g.nextSibling;e.insertBefore(g,m),d?e.insertBefore(m,d):e.appendChild(m),N(e.childNodes[u],r,n)}else e.replaceChild(k(r,n),m)}else N(e.childNodes[u],r,n)}}let l=e.childNodes.length;for(;l>c;)e.removeChild(e.lastChild),l--;if(i>c){let u=document.createDocumentFragment();for(let r=c;r<t.length;r++)u.appendChild(k(t[r],n));e.appendChild(u)}}function T(e){if((e==null?void 0:e.indexOf("_html:"))===0){let t=document.createElement("div");return t.insertAdjacentHTML("afterbegin",e.substring(6)),t}return document.createTextNode(e??"")}function k(e,t){if(e instanceof HTMLElement||e instanceof SVGElement)return e;if(typeof e=="string")return T(e);if(!e.tag||typeof e.tag=="function")return T(JSON.stringify(e));let n=(t=t||e.tag==="svg")?document.createElementNS("http://www.w3.org/2000/svg",e.tag):document.createElement(e.tag);return M(n,e.props,t),e.children&&e.children.forEach(s=>n.appendChild(k(s,t))),n}function M(e,t,n){let s=e._props||{};t=function(o,i){i.class=i.class||i.className,delete i.className;let c={};return o&&Object.keys(o).forEach(l=>c[l]=null),i&&Object.keys(i).forEach(l=>c[l]=i[l]),c}(s,t||{}),e._props=t;for(let o in t){let i=t[o];if(o.startsWith("data-")){let c=o.substring(5).replace(/-(\w)/g,l=>l[1].toUpperCase());e.dataset[c]!==i&&(i||i===""?e.dataset[c]=i:delete e.dataset[c])}else if(o==="style")if(e.style.cssText&&(e.style.cssText=""),typeof i=="string")e.style.cssText=i;else for(let c in i)e.style[c]!==i[c]&&(e.style[c]=i[c]);else if(o.startsWith("xlink")){let c=o.replace("xlink","").toLowerCase();i==null||i===!1?e.removeAttributeNS("http://www.w3.org/1999/xlink",c):e.setAttributeNS("http://www.w3.org/1999/xlink",c,i)}else o.startsWith("on")?i&&typeof i!="function"?typeof i=="string"&&(i?e.setAttribute(o,i):e.removeAttribute(o)):e[o]=i:/^id$|^class$|^list$|^readonly$|^contenteditable$|^role|-/g.test(o)||n?e.getAttribute(o)!==i&&(i?e.setAttribute(o,i):e.removeAttribute(o)):e[o]!==i&&(e[o]=i);o==="key"&&i&&(P[i]=e)}t&&typeof t.ref=="function"&&window.requestAnimationFrame(()=>t.ref(e))}function E(e,t,n=0){var s;if(typeof e=="string")return e;if(Array.isArray(e))return e.map(i=>E(i,t,n++));let o=e;if(e&&typeof e.tag=="function"&&Object.getPrototypeOf(e.tag).t&&(o=function(i,c,l){let{tag:u,props:r,children:m}=i,p="_"+l,g=r&&r.id;g?p=g:g=`_${l}${Date.now()}`;let d="section";r&&r.as&&(d=r.as,delete r.as),c.i||(c.i={});let h=c.i[p];if(!(h&&h instanceof u&&h.element)){let v=document.createElement(d);h=c.i[p]=new u(Object.assign(Object.assign({},r),{children:m})).start(v)}if(h.mounted){let v=h.mounted(r,m,h.state);v!==void 0&&h.setState(v)}return M(h.element,r,!1),h.element}(e,t,n)),o&&Array.isArray(o.children)){let i=(s=o.props)===null||s===void 0?void 0:s._component;if(i){let c=0;o.children=o.children.map(l=>E(l,i,c++))}else o.children=o.children.map(c=>E(c,t,n++))}return o}var J=(e,t={})=>class extends HTMLElement{constructor(){super()}get component(){return this._component}get state(){return this._component.state}static get observedAttributes(){return(t.observedAttributes||[]).map(n=>n.toLowerCase())}connectedCallback(){if(this.isConnected&&!this._component){let n=t||{};this._shadowRoot=n.shadow?this.attachShadow({mode:"open"}):this;let s=n.observedAttributes||[],o=s.reduce((l,u)=>{let r=u.toLowerCase();return r!==u&&(l[r]=u),l},{});this._attrMap=l=>o[l]||l;let i={};Array.from(this.attributes).forEach(l=>i[this._attrMap(l.name)]=l.value),s.forEach(l=>{this[l]!==void 0&&(i[l]=this[l]),Object.defineProperty(this,l,{get:()=>i[l],set(u){this.attributeChangedCallback(l,i[l],u)},configurable:!0,enumerable:!0})});let c=this.children?Array.from(this.children):[];if(c.forEach(l=>l.parentElement.removeChild(l)),this._component=new e(Object.assign(Object.assign({},i),{children:c})).mount(this._shadowRoot,n),this._component._props=i,this._component.dispatchEvent=this.dispatchEvent.bind(this),this._component.mounted){let l=this._component.mounted(i,c,this._component.state);l!==void 0&&(this._component.state=l)}this.on=this._component.on.bind(this._component),this.run=this._component.run.bind(this._component),n.render!==!1&&this._component.run(".")}}disconnectedCallback(){var n,s,o,i;(s=(n=this._component)===null||n===void 0?void 0:n.unload)===null||s===void 0||s.call(n),(i=(o=this._component)===null||o===void 0?void 0:o.unmount)===null||i===void 0||i.call(o),this._component=null}attributeChangedCallback(n,s,o){if(this._component){let i=this._attrMap(n);this._component._props[i]=o,this._component.run("attributeChanged",i,s,o),o!==s&&t.render!==!1&&window.requestAnimationFrame(()=>{this._component.run(".")})}}},F=(e,t,n)=>{typeof customElements!="undefined"&&customElements.define(e,J(t,n))},L={meta:new WeakMap,defineMetadata(e,t,n){this.meta.has(n)||this.meta.set(n,{}),this.meta.get(n)[e]=t},getMetadataKeys(e){return e=Object.getPrototypeOf(e),this.meta.get(e)?Object.keys(this.meta.get(e)):[]},getMetadata(e,t){return t=Object.getPrototypeOf(t),this.meta.get(t)?this.meta.get(t)[e]:null}};function z(e,t={}){return function(n,s){let o=e?e.toString():s;L.defineMetadata("apprun-update:"+o,{name:o,key:s,options:t},n)}}function Q(e,t){return function(n){return F(e,n,t),n}}var _=(e,t)=>(t?e.state[t]:e.state)||"",y=(e,t,n)=>{if(t){let s=e.state||{};s[t]=n,e.setState(s)}else e.setState(n)},x=new Map;a.on("get-components",e=>e.components=x);var U=e=>e,b=class{constructor(t,n,s,o){this.state=t,this.view=n,this.update=s,this.options=o,this._app=new S,this._actions=[],this._global_events=[],this._history=[],this._history_idx=-1,this._history_prev=()=>{this._history_idx--,this._history_idx>=0?this.setState(this._history[this._history_idx],{render:!0,history:!1}):this._history_idx=0},this._history_next=()=>{this._history_idx++,this._history_idx<this._history.length?this.setState(this._history[this._history_idx],{render:!0,history:!1}):this._history_idx=this._history.length-1},this.start=(i=null,c)=>this.mount(i,Object.assign(Object.assign({},c),{render:!0}))}render(t,n){a.render(t,n,this)}_view(t){if(!this.view)return;let n=a.createElement;a.h=a.createElement=(o,i,...c)=>(i&&Object.keys(i).forEach(l=>{l.startsWith("$")&&(((u,r,m,p)=>{if(u.startsWith("$on")){let g=r[u];if(u=u.substring(1),typeof g=="boolean")r[u]=d=>p.run(u,d);else if(typeof g=="string")r[u]=d=>p.run(g,d);else if(typeof g=="function")r[u]=d=>p.setState(g(p.state,d));else if(Array.isArray(g)){let[d,...h]=g;typeof d=="string"?r[u]=v=>p.run(d,...h,v):typeof d=="function"&&(r[u]=v=>p.setState(d(p.state,...h,v)))}}else if(u==="$bind"){let g=r.type||"text",d=typeof r[u]=="string"?r[u]:r.name;if(m==="input")switch(g){case"checkbox":r.checked=_(p,d),r.onclick=h=>y(p,d||h.target.name,h.target.checked);break;case"radio":r.checked=_(p,d)===r.value,r.onclick=h=>y(p,d||h.target.name,h.target.value);break;case"number":case"range":r.value=_(p,d),r.oninput=h=>y(p,d||h.target.name,Number(h.target.value));break;default:r.value=_(p,d),r.oninput=h=>y(p,d||h.target.name,h.target.value)}else m==="select"?(r.value=_(p,d),r.onchange=h=>{h.target.multiple||y(p,d||h.target.name,h.target.value)}):m==="option"?(r.selected=_(p,d),r.onclick=h=>y(p,d||h.target.name,h.target.selected)):m==="textarea"&&(r.innerHTML=_(p,d),r.oninput=h=>y(p,d||h.target.name,h.target.value))}else a.run("$",{key:u,tag:m,props:r,component:p})})(l,i,o,this),delete i[l])}),n(o,i,...c));let s=this.view(t);return a.h=a.createElement=n,s}renderState(t,n=null){if(!this.view)return;let s=n||this._view(t);if(a.debug&&a.run("debug",{component:this,_:s?".":"-",state:t,vdom:s,el:this.element}),typeof document!="object")return;let o=typeof this.element=="string"?document.getElementById(this.element):this.element;if(o){let i="_c";this.unload?o._component===this&&o.getAttribute(i)===this.tracking_id||(this.tracking_id=new Date().valueOf().toString(),o.setAttribute(i,this.tracking_id),typeof MutationObserver!="undefined"&&(this.observer||(this.observer=new MutationObserver(c=>{c[0].oldValue!==this.tracking_id&&document.body.contains(o)||(this.unload(this.state),this.observer.disconnect(),this.observer=null)})),this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:[i]}))):o.removeAttribute&&o.removeAttribute(i),o._component=this}n||this.render(o,s),this.rendered&&this.rendered(this.state)}setState(t,n={render:!0,history:!1}){if(t instanceof Promise)Promise.all([t,this._state]).then(s=>{s[0]&&this.setState(s[0])}).catch(s=>{throw console.error(s),s}),this._state=t;else{if(this._state=t,t==null)return;this.state=t,n.render!==!1&&this.renderState(t),n.history!==!1&&this.enable_history&&(this._history=[...this._history,t],this._history_idx=this._history.length-1),typeof n.callback=="function"&&n.callback(this.state)}}mount(t=null,n){var s,o;return console.assert(!this.element,"Component already mounted."),this.options=n=Object.assign(Object.assign({},this.options),n),this.element=t,this.global_event=n.global_event,this.enable_history=!!n.history,this.enable_history&&(this.on(n.history.prev||"history-prev",this._history_prev),this.on(n.history.next||"history-next",this._history_next)),n.route&&(this.update=this.update||{},this.update[n.route]=U),this.add_actions(),this.state=(o=(s=this.state)!==null&&s!==void 0?s:this.model)!==null&&o!==void 0?o:{},typeof this.state=="function"&&(this.state=this.state()),n.render?this.setState(this.state,{render:!0,history:!0}):this.setState(this.state,{render:!1,history:!0}),a.debug&&(x.get(t)?x.get(t).push(this):x.set(t,[this])),this}is_global_event(t){return t&&(this.global_event||this._global_events.indexOf(t)>=0||t.startsWith("#")||t.startsWith("/")||t.startsWith("@"))}add_action(t,n,s={}){n&&typeof n=="function"&&(s.global&&this._global_events.push(t),this.on(t,(...o)=>{a.debug&&a.run("debug",{component:this,_:">",event:t,p:o,current_state:this.state,options:s});let i=n(this.state,...o);a.debug&&a.run("debug",{component:this,_:"<",event:t,p:o,newState:i,state:this.state,options:s}),this.setState(i,s)},s))}add_actions(){let t=this.update||{};L.getMetadataKeys(this).forEach(s=>{if(s.startsWith("apprun-update:")){let o=L.getMetadata(s,this);t[o.name]=[this[o.key].bind(this),o.options]}});let n={};Array.isArray(t)?t.forEach(s=>{let[o,i,c]=s;o.toString().split(",").forEach(l=>n[l.trim()]=[i,c])}):Object.keys(t).forEach(s=>{let o=t[s];(typeof o=="function"||Array.isArray(o))&&s.split(",").forEach(i=>n[i.trim()]=o)}),n["."]||(n["."]=U),Object.keys(n).forEach(s=>{let o=n[s];typeof o=="function"?this.add_action(s,o):Array.isArray(o)&&this.add_action(s,o[0],o[1])})}run(t,...n){let s=t.toString();return this.is_global_event(s)?a.run(s,...n):this._app.run(s,...n)}on(t,n,s){let o=t.toString();return this._actions.push({name:o,fn:n}),this.is_global_event(o)?a.on(o,n,s):this._app.on(o,n,s)}unmount(){var t;(t=this.observer)===null||t===void 0||t.disconnect(),this._actions.forEach(n=>{let{name:s,fn:o}=n;this.is_global_event(s)?a.off(s,o):this._app.off(s,o)})}};b.t=!0;var C=e=>{if(e||(e="#"),e.startsWith("#")){let[t,...n]=e.split("/");a.run(t,...n)||a.run("///",t,...n),a.run("//",t,...n)}else if(e.startsWith("/")){let[t,n,...s]=e.split("/");a.run("/"+n,...s)||a.run("///","/"+n,...s),a.run("//","/"+n,...s)}else a.run(e)||a.run("///",e),a.run("//",e)};a.h=a.createElement=function(e,t,...n){let s=V(n);if(typeof e=="string")return{tag:e,props:t,children:s};if(Array.isArray(e))return e;if(e===void 0&&n)return s;if(Object.getPrototypeOf(e).t)return{tag:e,props:t,children:s};if(typeof e=="function")return e(t,s);throw new Error("Unknown tag in vdom "+e)},a.render=function(e,t,n){I(e,t,n)},a.Fragment=K,a.webComponent=F,a.start=(e,t,n,s,o)=>{let i=Object.assign(Object.assign({},o),{render:!0,global_event:!0}),c=new b(t,n,s);return o&&o.rendered&&(c.rendered=o.rendered),c.mount(e,i),c};var O=e=>{};a.on("$",O),a.on("debug",e=>O),a.on("//",O),a.on("#",O),a.route=C,a.on("route",e=>a.route&&a.route(e)),typeof document=="object"&&document.addEventListener("DOMContentLoaded",()=>{a.route===C&&(window.onpopstate=()=>C(location.hash),document.body.hasAttribute("apprun-no-init")||C(location.hash))}),typeof window=="object"&&(window.Component=b,window.React=a,window.on=z,window.customElement=Q);var f=a;var $=class extends b{constructor(){super(...arguments);this.state="Home";this.view=t=>a.h("div",null,a.h("h1",null,t));this.update={"#Home":t=>t}}},q=$;var W=class extends b{constructor(){super(...arguments);this.state="About";this.view=t=>a.h("div",null,a.h("h1",null,t));this.update={"#About":t=>t}}},B=W;var H=class extends b{constructor(){super(...arguments);this.state="Contact";this.view=t=>a.h("div",null,a.h("h1",null,t));this.update={"#Contact":t=>t}}},D=H;f.on("//",e=>{let t=document.querySelectorAll(".navbar-nav li");for(let s=0;s<t.length;++s)t[s].classList.remove("active");let n=document.querySelector(`[href='${e}']`);n&&n.parentElement.classList.add("active")});var G=()=>f.h("div",{class:"container"},f.h("nav",{class:"navbar navbar-expand-lg navbar-light bg-light"},f.h("a",{class:"navbar-brand",href:"#"},"Project Name"),f.h("button",{class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},f.h("span",{class:"navbar-toggler-icon"})),f.h("div",{class:"collapse navbar-collapse",id:"navbarSupportedContent"},f.h("ul",{class:"navbar-nav mr-auto"},f.h("li",{class:"nav-item active"},f.h("a",{class:"nav-link",href:"#Home"},"Home",f.h("span",{class:"sr-only"},"(current)"))),f.h("li",{class:"nav-item"},f.h("a",{class:"nav-link",href:"#About"},"About")),f.h("li",{class:"nav-item"},f.h("a",{class:"nav-link",href:"#Contact"},"Contact"))))),f.h("div",{class:"container",id:"my-app"}));f.render(document.body,f.h(G,null));var R="my-app";new q().start(R);new B().mount(R);new D().mount(R);})();
